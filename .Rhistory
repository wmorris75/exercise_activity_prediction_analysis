install.packages(ggplot2)
install.packages(ggplot)
install.packages("ggplot2")
install.package("ggplot2")
install.packages("ggplot")
install.packages("ggplot2", dependencies = TRUE)
install.packages("ggplot2")
install.packages("ggplot2")
install.packages("ggplot2", dependencies = TRUE)
install.packages("ggplot2", dependencies = TRUE)
install.packages("ggplot2", dependencies = TRUE)
install.packages("ggplot2", dependencies = TRUE)
install.packages("ggplot2", dependencies = TRUE)
install.packages(c('reshape2','scales'))
install.packages("ggplot2", dependencies = TRUE)
data(mtcars)
names(mtcars).length
dim(names(mtcars))
names(mtcars)
(names(mtcars)).length
class(names(mtcars))
dim(mtcars)
data(mtcars)
fit1<-lm(mpg ~ am, data = mtcars)
summary(mtcars)
summary(mtcars)$coeff
summary(fit1)$coeff
fit2<-lm(mpg ~ am + hp, data = mtcars )
summary(fit2)$coeff
fit3<-lm(mpg ~ am + hp + wt, data = mtcars)
summary(fit3)$coeff
fit3<-lm(mpg ~ am + hp + wt + gear, data = mtcars)
summary(fit4)$coeff
summary(fit3)$coeff
fit5<-lm(mpg ~ am + hp + wt + gear + carb, data = mtcars)
summary(fit5)$coeff
fit6<-lm(mpg ~ am + hp + wt + gear + carb + disp, data = mtcars)
summary(fit6)$coeff
fit7<-lm(mpg ~ am + hp + wt + gear + carb + disp + drat, data = mtcars)
summary(fit7)$coeff
fit7<-lm(mpg ~ am + hp + wt + gear + carb + disp + drat + vs, data = mtcars)
summary(fit7)$coeff
fit7<-lm(mpg ~ am + hp + wt + gear + carb + disp + drat + vs + qsec, data = mtcars)
summary(fit7)$coeff
fit1<-lm(mpg ~ am, data = mtcars)
fit2<-lm(mpg ~ am + hp, data = mtcars )
fit3<-lm(mpg ~ am + hp + wt, data = mtcars)
fit4<-lm(mpg ~ am + hp + wt + gear, data = mtcars)
fit5<-lm(mpg ~ am + hp + wt + gear + carb, data = mtcars)
fit6<-lm(mpg ~ am + hp + wt + gear + carb + disp, data = mtcars)
fit7<-lm(mpg ~ am + hp + wt + gear + carb + disp + drat, data = mtcars)
fit8<-lm(mpg ~ ., data = mtcars)
rbind(sum(fit1)$coeff[2,], sum(fit2)$coeff[2,], sum(fit3)$coeff[2,],sum(fit4)$coeff[2,],sum(fit5)$coeff[2,],sum(fit6)$coeff[2,], sum(fit7)$coeff[2,],sum(fit8)$coeff[2,])
rbind(summary(fit1)$coeff[2,], summary(fit2)$coeff[2,], summary(fit3)$coeff[2,],summary(fit4)$coeff[2,],summary(fit5)$coeff[2,],summary(fit6)$coeff[2,], summary(fit7)$coeff[2,],summary(fit8)$coeff[2,])
lm(mpg ~ ., data = mtcars)
s<-lm(mpg ~ ., data = mtcars)
summary(s)$coeff
fit1<-lm(mpg ~ am, data = mtcars)
fit2<-lm(mpg ~ am + hp, data = mtcars )
fit3<-lm(mpg ~ am + hp + wt, data = mtcars)
fit4<-lm(mpg ~ am + hp + wt + gear, data = mtcars)
fit5<-lm(mpg ~ am + hp + wt + gear + carb, data = mtcars)
fit6<-lm(mpg ~ am + hp + wt + gear + carb + disp, data = mtcars)
fit7<-lm(mpg ~ am + hp + wt + gear + carb + disp + drat, data = mtcars)
fit8<-lm(mpg ~ factor(am) + ., data = mtcars)
rbind(summary(fit1)$coeff[2,], summary(fit2)$coeff[2,], summary(fit3)$coeff[2,],summary(fit4)$coeff[2,],summary(fit5)$coeff[2,],summary(fit6)$coeff[2,], summary(fit7)$coeff[2,],summary(fit8)$coeff[2,])
anova(fit1, fit2, fit3, fit4, fit5, fit6, fit7, fit8)
f<-lm(mpg ~ am + hp + wt + disp, data = mtcars)
summary(f)$coeff
summary(fit8)$coeff
rbind(summary(fit1)$coeff[2,], summary(fit2)$coeff[2,], summary(fit3)$coeff[2,],summary(fit4)$coeff[2,],summary(fit5)$coeff[2,],summary(fit6)$coeff[2,], summary(fit7)$coeff[2,],summary(fit8)$coeff[2,])
compare_fit<-rbind(summary(fit1)$coeff[2,], summary(fit2)$coeff[2,], summary(fit3)$coeff[2,],summary(fit4)$coeff[2,],summary(fit5)$coeff[2,],summary(fit6)$coeff[2,], summary(fit7)$coeff[2,],summary(fit8)$coeff[2,])
compare_fit
lm(mpg ~ am + wt, data = mtcars )
summary(lm(mpg ~ am + wt, data = mtcars ))$coeff
summary(lm(mpg ~ am + hp + wt, data = mtcars))$coeff
anova(fit1, fit2, fit3, fit4, fit5, fit6, fit7, fit8)
compare_fit
head(mtcars)
summary(fit3)$coeff
summary(fit3)$coeff
summary(fit8)$coeff
summary(fit4)$coeff
summary(fit5)$coeff
head(mtcars)
g = 2.084 + (-0.0375*110) + (2.620 *  -2.87857541) + 34
g
tail(mtcars)
2.084 + (-0.0375*91) + (2.14 *  -2.87857541) + 34
(-0.0375*91) + (2.14 *  -2.87857541) + 34
summary(fit3)$coeff
fit1<-lm(mpg ~ factor(am), data = mtcars)
fit2<-lm(mpg ~ factor(am) + hp, data = mtcars )
fit3<-lm(mpg ~ factor(am) + hp + wt, data = mtcars)
fit4<-lm(mpg ~ factor(am) + hp + wt + gear, data = mtcars)
fit5<-lm(mpg ~ factor(am) + hp + wt + gear + carb, data = mtcars)
fit6<-lm(mpg ~ factor(am) + hp + wt + gear + carb + disp, data = mtcars)
fit7<-lm(mpg ~ factor(am) + hp + wt + gear + carb + disp + drat, data = mtcars)
fit8<-lm(mpg ~ factor(am) + ., data = mtcars)
summary(fit3)$coeff
predict(fit3, newdata=data.frame(wt=2.68, hp= 99), interval="confidence")
predict(fit3, newdata=data.frame(wt=2.68, hp= 99, factor(am)), interval="confidence")
predict(fit3,  factor(am), newdata=data.frame(wt=2.68, hp= 99), interval="confidence", data = mtcars)
predict(fit3, newdata=data.frame(wt=2.68, hp= 99), interval="confidence", data = mtcars)
predict(fit3, newdata=data.frame(wt = mtcars$wt, hp = mtcars$hp), interval="confidence", data = mtcars)
predict(fit3)
mtcars
(-0.0375*230) + (5.35 *  -2.87857541) + 34
(-0.0375*230) + (5.35 *  -2.87857541) + 34 + 2.08
predict(fit3, newdata=data.frame(c (wt = mtcars$wt, hp = mtcars$hp)), interval="confidence", data = mtcars)
predict(fit3, newdata=data.frame(c (wt = mtcars$wt, hp = mtcars$hp, mtcars$am)), interval="confidence", data = mtcars)
predict(fit3, newdata=data.frame(c (wt = mtcars$wt, hp = mtcars$hp, am = mtcars$am)), interval="confidence", data = mtcars)
predict(fit3, newdata=data.frame(c (wt = mtcars$wt, hp = mtcars$hp, am = mtcars$am)), interval="confidence")
predict(fit3, newdata=data.frame(c(wt = mtcars$wt, hp = mtcars$hp, am = as.factor(mtcars$am))), interval="confidence")
fit3
resid(fit3)
pairs(mtcars)
plot(predict(fit8), resid(fit8), pch = '.')
fit8
plot(predict(fit8), resid(fit8), pch = '.')
resid(fit8)
predict(fit8)
plot(predict(fit8), resid(fit8), pch = '.', type = 'point')
plot(predict(fit8), resid(fit8), pch = '.', type = 'points')
plot(predict(fit8), resid(fit8), pch = '.', type = 'p')
plot(predict(fit8), resid(fit8), pch = '.', type = p)
plot(predict(fit8), resid(fit8), pch = '.')
plot(predict(fit8), resid(fit8))
plot(predict(fit3), resid(fit3))
plot(predict(fit2), resid(fit2))
plot(predict(fit1), resid(fit1))
plot(predict(fit4), resid(fit4))
plot(predict(fit3), resid(fit3))
confint(fit3)
confint(fit4)
confint(fit8)
confint(fit1)
confint(fit2)
resid(fit3)
predict(resid(fit3))
plot(fit3)
plot(fit8)
plot(fit3)
par(mfrow = c(2, 2))
plot(fit3)
confint(fit2)
confint(fit3)
compare_fit
predict(fit3)
head(mtcars)
summary(fit3)
confint(fit3)
confint(fit8)
confint(fit4)
confint(fit5)
confint(fit6)
confint(fit3)
confint(fit8)
plot(predict(mtcars), predict(fit3))
plot(resid(fit3), predict(fit3))
plot(resid(fit4), predict(fit4))
plot(resid(fit8), predict(fit8))
plot(resid(fit2), predict(fit2))
plot(resid(fit5), predict(fit5))
par(mfrow = c(2, 2))
plot(fit3)
plot(fit8)
plot(resid(fit3), predict(fit3))
abline(a = 0)
abline(x = 0)
plot(predict(fit3), resid(fit3))
line(y = 0, colors = 'red')
line(x, y = 0, colors = 'red')
par(mfrow = c(2, 2))
plot(predict(fit3), resid(fit3))
abline(yintercept = 0)
abline(h = 0, v = 0, col = "gray60")
abline(h = 2, v = 0, col = "gray60")
abline(h = -2, v = 0, col = "gray60")
plot(predict(fit2), resid(fit2))
abline(h = 2, v = 0, col = "gray60")
abline(h = -2, v = 0, col = "gray60")
abline(h = 0, v = 0, col = "gray60")
plot(predict(fit6), resid(fit6))
abline(h = -2, v = 0, col = "gray60")
abline(h = 2, v = 0, col = "gray60")
abline(h = 0, v = 0, col = "gray60")
plot(predict(fit8), resid(fit8))
abline(h = 0, v = 0, col = "gray60")
abline(h = 2, v = 0, col = "gray60")
abline(h = -2, v = 0, col = "gray60")
abline(h = -2, v = 0, col = "red")
plot(predict(fit3), resid(fit3))
plot(predict(fit3), resid(fit3))
confint(resid(fit3))
confint((fit3))
summary(fit3)
summary(fit4)
summary(fit8)
f<-mtcars$mpg
predict(fit3)
class(predict(fit3))
predict(fit3)[1]
predict(fit3)[1,2]
predict(fit3)[1]
plot(f, predict(fit3))
abline()
line(f, predict(fit3))
abline(f ~ predict(fit3))
abline(f ~ predict(fit3), col = "red")
lines(lowess(f ,predict(fit3)), col="blue")
line(f, predict(fit8))
plot(f, predict(fit8))
line(f, predict(fit8))
abline(f ~ predict(fit8), col = "red")
lines(lowess(f ,predict(fit8)), col="blue")
summary(fit3)
confint(fit3)
compare_fit
devtools::install_github("rstudio/rmarkdown")
setwd("~/Documents/DataScience/Practical Machine Learning/Project")
set.seed(323)
rfFit<-train(classe ~ ., data=training, method="rf")
rfprediction<-predict(rfFit, testing)
#Accuracy
confusionMatrix(rfprediction, testing$classe)   #0.9475  accuracy
#Used rf as prediction model; 0.42% accuracy
set.seed(323)
library(caret)
library(ggplot2)
library(MASS)
training_data<-read.csv("pml-training.csv")
testing_data<-read.csv("pml-testing.csv")
train_data<-training_data[(grep("accel|classe", names(training_data)))]
test_data<-testing_data[(grep("accel|classe", names(testing_data)))]
names(train_data)
str(train_data)
#variables to be removed from data
rm_names<-c("var_total_accel_belt", "var_accel_arm", "var_accel_dumbbell", "var_accel_forearm")
new_train_data<-train_data[!names(train_data) %in% rm_names]
new_test_data<-test_data[!names(test_data) %in% rm_names]
str(new_train_data)
set.seed(323)
new_train_data$classe <-as.factor(new_train_data$classe)
inTrain <- createDataPartition(new_train_data$classe, p=0.7, list=FALSE)
training<-new_train_data[inTrain,]
testing<-new_train_data[-inTrain,]
set.seed(323)
rpartFit<-train(classe ~ ., data=training, method="rpart")
rPartprediction<-predict(rpartFit, testing)
#Accuracy
confusionMatrix(rPartprediction, testing$classe)   #0.42  accuracy
#Used rpart as prediction model; 0.42% accuracy
